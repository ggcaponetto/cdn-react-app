<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>External React App</title>
</head>
<body>
<h3>some website content not part of react</h3>
<!--COPY THIS SNIPPET HERE - START -->
<div id="sep-core"></div>
<h3>some website content not part of react</h3>
<div id="sep-map" style="width:100%; height: 500px"></div>
<h3>some website content not part of react</h3>
<div id="sep-address"></div>
<h3>some website content not part of react</h3>
<div id="sep-object-display"></div>

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"/>
<script id="external-react-app"></script>
<script type="text/javascript">
  // change path to match your file:
  window.onload = function () {
    const sepEventName = 'sep-event'
    // praedictio_public token
    // const token = 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJwcmFlZGljdGlvX3B1YmxpYyIsIm5iZiI6IjE2MDEwMjY0NDUiLCJqdGkiOiJlYzZkMzBhYS1hMGU2LTRlZjYtOTEyOS1mY2JiMzA1OWM1MjkiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9uYW1laWRlbnRpZmllciI6ImU2NDY4NWZhLTFiODgtNDcyZS1iZjkzLTU5NDk3NjUzNTkyNiIsImh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd3MvMjAwOC8wNi9pZGVudGl0eS9jbGFpbXMvcm9sZSI6IlB1YmxpYyIsIk1hbmRhbnQiOiJwcmFlZGljdGlvIiwiQXV0aG9yaXplZFJlc291cmNlcyI6IiptYXJrZXRzZW5zZSo6R0VUfCphZGRyZXNzcG9pbnRzLW5lYXJlc3QtYnktY29vcmRpbmF0ZXMqOkdFVHwqc2VhcmNoYWRkcmVzcyo6UE9TVCIsIkF1dGhvcml6ZWRSZWNvcmRzIjoiYWxsIiwiRXhjbHVkZWRGaWVsZHMiOiJub25lIiwiRm9yYmlkZGVuRmlsdGVycyI6Im5vbmUiLCJleHAiOjE5MTY1NTkyNDUsImlzcyI6IkN3S0F5NWpJbVlTSk9RUW5obEF3cnZLT0k1RWtmMFNpIiwiYXVkIjoiZW5lcmd5YXBwcy5jaCJ9.XIZ0boz1GExYKp0qbgpeRRS4FdjDuz1r-9kVLOCljeV-neXkll7hcNF-7odywg9OKI9EzoW2LlHBVIM8wQwRk-olbjr3rayGkuw2LSCexP6ze8f2MOhnch05IctnUVy8U0LAI2JJLDGtjke8yEdkV7r37ykrBmnVKKBroLgeaTi-2zrVCtmIp9P97tMrMPzqYy9pz7N0wX5CDt3MTfTggIJm8fukmAwgqLFCfGCsFZPaOVLpWVZIISAwt5MV8DN8aA2CNBxFDYQt1X8yTr9-TvrQ0NWBu0epxNDOm-OAVxVSGprjlkaq7FyKwV9CkgzMlEuMfp0tg8pqzezaPtXYZg'
    // raumpioniere
    const token = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJyYXVtcGlvbmllcmVfcHVibGljIiwibmJmIjoiMTYwNTAxMjAxNyIsImp0aSI6Ijc5YTMzMTBlLWIwYmItNDQ3Zi1iYzYyLWQwYzNiYTgwMDIxMCIsImh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDUvMDUvaWRlbnRpdHkvY2xhaW1zL25hbWVpZGVudGlmaWVyIjoiNDA0NTgyMDMtNDEzYi00MjUyLTllYjAtYTM2ZjM1OTA2NDdkIiwiaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93cy8yMDA4LzA2L2lkZW50aXR5L2NsYWltcy9yb2xlIjoiUHVibGljIiwiTWFuZGFudCI6InJhdW1waW9uaWVyZSIsIkF1dGhvcml6ZWRSZXNvdXJjZXMiOiIqc2VhcmNoYWRkcmVzcyo6UE9TVHwqbWFya2V0c2Vuc2UvYWRkcmVzc3BvaW50LWJ5LWFkZHJlc3NpZCo6R0VUfCptYXJrZXRzZW5zZS9wYXJjZWxidWlsZGZlYXR1cmVzLXN0YXRpc3RpY3MtYnktcGFyY2VsLWJ5LWFkZHJlc3NpZCo6R0VUfCpmZWF0dXJlY29sbGVjdGlvbio6R0VUfCphZGRyZXNzcG9pbnRzLW5lYXJlc3QtYnktY29vcmRpbmF0ZXMqOkdFVCIsIkF1dGhvcml6ZWRSZWNvcmRzIjoiYWxsIiwiRXhjbHVkZWRGaWVsZHMiOiIqbWFya2V0c2Vuc2UvYWRkcmVzc3BvaW50LWJ5LWFkZHJlc3NpZCo6YW56YWhsKixiYXVnZXN1Y2gscmVub3ZhdGlvbnNqYWhyKixiYXVqYWhyaW50LGdlYmZsYWVjaGUsZ2Vic3RhdHVzLGdlYmthdGVnb3JpZSosem9uZSxkaXN0cmljdHR5cGUsYnVpbGRpbmdhcmVhKiwqdGFyaWYsKnNpbmNlLHBvcHVsYXRpb24qLHJvd3ZlcnNpb24qLGxhc3R1cGRhdGVkLHB1YmxpYyosd29obnVuZyp8KmZlYXR1cmVjb2xsZWN0aW9uKjphbnphaGwqLGJhdWdlc3VjaCxyZW5vdmF0aW9uc2phaHIqLGJhdWphaHJpbnQsZ2ViZmxhZWNoZSxnZWJzdGF0dXMsZ2Via2F0ZWdvcmllKix6b25lLGRpc3RyaWN0dHlwZSxidWlsZGluZ2FyZWEqLCp0YXJpZiwqc2luY2UscG9wdWxhdGlvbioscm93dmVyc2lvbiosbGFzdHVwZGF0ZWQscHVibGljKix3b2hudW5nKnwqYWRkcmVzc3BvaW50cy1uZWFyZXN0LWJ5LWNvb3JkaW5hdGVzKjpyZWNvcmQqLHJvd3ZlcnNpb24qLGxhdGJ1aWxkaW5nLGxvbmdidWlsZGluZyxsYXN0dXBkYXRlZCosKnNpbmNlLGxpbmtzIiwiRm9yYmlkZGVuRmlsdGVycyI6Im5vbmUiLCJleHAiOjE5MjA1NDQ4MTcsImlzcyI6IkN3S0F5NWpJbVlTSk9RUW5obEF3cnZLT0k1RWtmMFNpIiwiYXVkIjoiZW5lcmd5YXBwcy5jaCJ9.mcFROFzhSyzQN0PA4Ud_EipwG1K2GoykaBeUzs_l2PUD1Slc5I5sRgBgCpnHjjkQ3v1tLi_8ZOW6eHtoLoFNxLmS7SrY6hRV5RSQ756NfGe6ib7g3yFs7ZtFxBjdf-XQihaqzgtD_AdJnRzLDhAjmYegRR2MVUZErwODxQBYA8TPqs6cepRR0zVs1wo3QqlDfhY3DJ6_jMhTzArFHEYyy3SUf5uqGFcEfuGW9NT-n3W1fWvRqGWJrZiyN2M3ljrJGzVfw9cmYZMajBCIsbz8g1osscXIEkHt9_fg1h4yTN05CGLIaCUiwT4CZG3K0gfSJVcA4asM7DdtSxS6yjl2Vg"
    let theme = encodeURIComponent(JSON.stringify({
      'palette': {
        'primary': {
          'main': '#039f00'
        },
        'secondary': {
          'main': '#0051b5'
        }
      }
    }))
    let lang = 'de-ch'
    let controls = JSON.stringify(false)
    let moduleVersion = 2
    let mapLayer = {
      MAP_OSM: 'MAP_OSM',
      MAP_SWISSTOPO_GREY_URL: 'MAP_SWISSTOPO_GREY_URL',
      MAP_SWISSTOPO_COLOR_URL: 'MAP_SWISSTOPO_COLOR_URL',
      MAP_CADASTRAL_COLOR_URL: 'MAP_CADASTRAL_COLOR_URL'
    }.MAP_SWISSTOPO_GREY_URL

    let overview = JSON.stringify(
      {
        privateInvestor: {
          filterCountViewId: 'open_marketsense_private_investor/filterCount',
          filterViewId: 'open_marketsense_private_investor/filter',
          options: {
            maxZoom: 15
          }
        }
      }.privateInvestor
    )

    window.addEventListener(sepEventName, (e) => {
      console.log('host: got event', { action: e.detail.action, payload: e.detail.payload })
      if (e.detail.action === 'loaded-marketsense') {
        window.dispatchEvent(new CustomEvent(sepEventName, {
          detail: {
            action: 'init-sep-map',
            payload: {
              mapContainerId: 'sep-map'
            }
          }
        }))
      }
      if (e.detail.action === 'loaded-address') {
        window.dispatchEvent(new CustomEvent(sepEventName, {
          detail: {
            action: 'init-sep-address',
            payload: {
              addressContainerId: 'sep-address'
            }
          }
        }))
      }
      if (e.detail.action === 'loaded-sep-object-display') {
        window.dispatchEvent(new CustomEvent(sepEventName, {
          detail: {
            action: 'init-sep-object-display',
            payload: {
              objectDisplayContainerId: 'sep-object-display'
            }
          }
        }))
      }
    })
    let mainScript = document.getElementById('external-react-app')
    mainScript.async = true
    mainScript.src = 'main.bundle.js?'
      + 'scriptId=sep-core'
      + '&sepEventName=' + sepEventName
      + '&moduleVersion=' + moduleVersion
      + '&v=' + Date.now()
      + '&token=' + token
      + '&theme=' + theme
      + '&mapLayer=' + mapLayer
      + '&overview=' + overview
      + '&lang=' + lang
      + '&controls=' + controls

    mainScript.addEventListener('load', function () {
      // the react app has rendered once
      console.log('external-react-app: script loaded')
    })
  }
</script>
<!--COPY THIS SNIPPET HERE - END -->
</body>
</html>
